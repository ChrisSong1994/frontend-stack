# 网页加载一次发起10个请求会创建几个tcp连接

在浏览器加载网页时，向同一服务器发起10个请求的TCP连接数量，主要取决于**HTTP协议版本**和**浏览器并发策略**，以下是技术细节分析：

---

### 一、HTTP协议版本差异
#### 1. **HTTP/1.1 场景**
- **连接机制**：浏览器对同一域名（同协议、同主机、同端口）默认允许**6个并发TCP连接**（Chrome等现代浏览器的标准）。  
- **请求处理**：每个TCP连接在同一时刻只能处理**1个请求**，未完成的请求需排队等待空闲连接。  
- **实际连接数**：  
  - 若10个请求均为同一域名，将创建**6个TCP连接**，每个连接依次处理多个请求（例如：6个连接分别处理2、2、2、2、1、1个请求）。  
  - 若服务器支持持久连接（Keep-Alive），这些TCP连接会复用，不会频繁重建。

#### 2. **HTTP/2 场景**
- **多路复用特性**：所有请求通过**1个TCP连接**并行传输，无需创建多个连接。  
- **性能优势**：彻底解决队头阻塞问题，10个请求在单一连接中并发完成。

---

### 二、关键影响因素
#### 1. **浏览器并发限制策略**
- 不同浏览器对同一域名的最大TCP连接数存在差异（如Firefox默认8个，Safari默认6个）。  
- 若请求资源分散到不同子域名（如`static1.example.com`和`static2.example.com`），每个子域名可独立使用最大连接数。

#### 2. **资源类型与优先级**
- 高优先级资源（如HTML、关键CSS/JS）可能优先占用TCP连接，低优先级资源（如图片）需等待。  
- 浏览器可能根据资源加载顺序动态调整连接分配。

---

### 三、优化建议
1. **升级至HTTP/2**：通过单一TCP连接处理所有请求，显著减少连接数并提升性能。  
2. **域名分片（HTTP/1.1适用）**：将资源分散到多个子域名，突破单域名连接数限制（例如使用4个子域名可扩展至24个并发连接）。  
3. **启用持久连接**：减少TCP握手和TLS协商开销（HTTP/1.1默认支持）。  
4. **资源合并与懒加载**：减少请求总数，如合并小文件或延迟加载非首屏资源。

---

### 四、典型场景示例
| **协议版本** | **TCP连接数** | **请求处理方式**             | **性能瓶颈**               |
|--------------|---------------|------------------------------|----------------------------|
| HTTP/1.1     | 6个           | 串行处理（需排队）           | 队头阻塞、连接数限制       |
| HTTP/2       | 1个           | 多路复用（并行处理）         | 无队头阻塞                 |
| HTTP/3       | 1个（QUIC）   | 基于UDP的多路复用 + 0-RTT    | 网络层优化，无TCP队头阻塞  |

> **总结**：在HTTP/1.1协议下，10个请求会触发浏览器创建最多6个TCP连接（Chrome标准），而HTTP/2/3仅需1个连接。实际开发中需根据协议版本和浏览器特性针对性优化。